name: Multi-repo Signed Commits

on:
  workflow_dispatch:

jobs:
  bump:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Build TypeScript
        run: npx tsc -p tsconfig.json

      - name: Run bump
        run: node ./.build/github/actions/rtp-bump.js
               - name: Bump versions

          # Loop over repos and sign/push each separately
               - name: Commit + sign for each repo
                 shell: bash
                 run: |
                   for repo in repos/*; do
                     echo "Signing commit for $repo"
                     npx --yes verified-bot-commit \
                       --files "$repo/**" \
                       --message "chore($repo): bump version" \
                       --token "${{ secrets.GH_PAT || github.token }}"
                   done
